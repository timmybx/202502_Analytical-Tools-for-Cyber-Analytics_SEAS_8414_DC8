# TESTING.md — Manual Verification Guide

This guide walks you through four manual tests:
1) **Benign URL**
2) **Malicious (Organized Cybercrime)**
3) **Malicious (State‑Sponsored)**
4) **Malicious (Hacktivist)**

Each test describes how to set the Streamlit sidebar, the **expected verdict**, and the **likely attribution**. Exact confidence and cluster IDs can vary slightly across runs.

---

## Before You Start

- App is running at **http://localhost:8501**.
- Models exist in `models/` (first run of `make up` trains them automatically).
- In the app, use the left sidebar to set features, then click **“Analyze & Initiate Response.”**

> Tip: If your run looks very different from the expected outcome, click **R** in the Streamlit app (or restart) to clear cache and try again.

---

## 1) Benign URL

**Set:**
- URL Length: **Normal**
- SSL Certificate Status: **Trusted**
- Sub‑domain Complexity: **One**
- URL has a Prefix/Suffix: **unchecked**
- URL uses an IP Address: **unchecked**
- Is it a shortened URL: **unchecked**
- URL contains '@' symbol: **unchecked**
- Is it an abnormal URL: **unchecked**
- Contains political / activist keywords: **unchecked**

**Expected:**
- **Verdict:** ✅ **Benign**
- **Threat Attribution tab:** Will state attribution runs only for malicious verdicts.
- **Prescriptive Plan:** Not generated (benign).

---

## 2) Malicious — Organized Cybercrime

**Set:**
- URL Length: **Long**
- SSL Certificate Status: **None**
- Sub‑domain Complexity: **Many**
- URL has a Prefix/Suffix: **checked**
- URL uses an IP Address: **checked**
- Is it a shortened URL: **checked**
- URL contains '@' symbol: **unchecked**
- Is it an abnormal URL: **checked**
- Contains political / activist keywords: **unchecked**

**Expected:**
- **Verdict:** 🚨 **Malicious**
- **Threat Attribution:** **Organized Cybercrime**
- **Prescriptive Plan:** Generated by your chosen GenAI provider.

---

## 3) Malicious — State‑Sponsored

**Set:**
- URL Length: **Long**
- SSL Certificate Status: **Trusted**
- Sub‑domain Complexity: **One**
- URL has a Prefix/Suffix: **checked**
- URL uses an IP Address: **unchecked**
- Is it a shortened URL: **unchecked**
- URL contains '@' symbol: **unchecked**
- Is it an abnormal URL: **unchecked**
- Contains political / activist keywords: **unchecked**

**Expected:**
- **Verdict:** 🚨 **Malicious**
- **Threat Attribution:** **State‑Sponsored**

---

## 4) Malicious — Hacktivist

**Set:**
- URL Length: **Long** (or **Normal**)
- SSL Certificate Status: **Suspicious** (Trusted can also work)
- Sub‑domain Complexity: **Many**
- URL has a Prefix/Suffix: **checked**
- URL uses an IP Address: **unchecked**
- Is it a shortened URL: **unchecked**
- URL contains '@' symbol: **unchecked**
- Is it an abnormal URL: **checked** (or sometimes unchecked)
- **Contains political / activist keywords: _checked_**  ← key distinguishing signal

**Expected:**
- **Verdict:** 🚨 **Malicious**
- **Threat Attribution:** **Hacktivist**

---

## What If Results Differ?

- The app derives the **cluster → profile** mapping by **majority vote** on the training data. If you tweak `train_model.py` or re‑seed the generator, the exact mapping could shift. The above combinations should still produce intuitively similar attributions.
- If the app shows “Attribution unavailable,” refresh or ensure both models exist in `models/` and the app has restarted after training.
